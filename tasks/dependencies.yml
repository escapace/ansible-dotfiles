---

- name: enable fish repository
  ansible.builtin.command:
    cmd: dnf config-manager --add-repo https://download.opensuse.org/repositories/shells:fish:release:3/CentOS-9_Stream/shells:fish:release:3.repo
  tags:
    - molecule-idempotence-notest

- name: ensure a list of packages installed
  ansible.builtin.dnf:
    name: "{{ packages }}"
    state: present
    allowerasing: true
  vars:
    packages:
      - bc
      - curl
      - fish
      - fuse
      - git
      - mosh
      - neovim
      - rsync
      - sudo
      - tmux
      - unzip
      - ripgrep
      - kitty-terminfo

- name: install vim requirements
  ansible.builtin.dnf:
    name: "{{ packages }}"
    state: present
    allowerasing: true
  vars:
    packages:
      - gcc
      - gcc-c++

- name: install pyenv requirements
  ansible.builtin.dnf:
    name: "{{ packages }}"
    state: present
    allowerasing: true
  vars:
    packages:
      - gcc
      - zlib-devel
      - bzip2
      - bzip2-devel
      - readline-devel
      - sqlite
      - sqlite-devel
      - openssl-devel
      - tk-devel
      - libffi-devel
      - xz-devel
  when: dotfiles_pyenv_install | bool
